apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  name:                 terraform-job-04
spec:
  entrypoint:           start-terraform-job-04
  # schedule:             "*/1 * * * *"
  # concurrencyPolicy:    "Forbid"
  # startingDeadlineSeconds: 0
  # successfulJobsHistoryLimit: 6
  # failedJobsHistoryLimit: 3
  volumeClaimTemplates:
  - metadata:
      name:             argo-workdir
    spec:
      accessModes:      [ "ReadWriteOnce" ]
      resources:
        requests:
          storage:      1Gi

  # workflowSpec:
  #   entrypoint:         start-terraform-job-04
  #   archiveLogs:        true

  templates:
    - name:           start-terraform-job-04
      steps:

        - - name:       get-date
            templateRef:
              name:     get-date-04
              template: get-now


        - - name:       clone-terraform-code-from-git
            templateRef:
              name:     git-operation-04
              template: get-clone
            arguments:
              parameters:
              - name:   gitRepo
                value:  https://github.com/OlafRadicke/daytona_beach.git
              - name:   gitBranch
                value:  "main"

        # - - name:       get-date
        #     templateRef:
        #       name:     get-date-04
        #       template: get-now



        - - name:       list-content-of-terragrunt-dir-2
            templateRef:
              name:     terragrunt-operation-04
              template: get-content-of-dir-3


        # - - name:       get-version-of-terragrunt
        #     templateRef:
        #       name:     terragrunt-operation-04
        #       template: get-version

